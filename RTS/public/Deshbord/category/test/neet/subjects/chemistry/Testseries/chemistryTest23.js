const questions = [
  {
    "num": 1,
    "question_en": "Which among the following oxides is amphoteric?",
    "question_hi": "निम्न में से कौन सा ऑक्साइड उभयधर्मी है?",
    "options_en": ["Na2O", "CaO", "Al2O3", "CO"],
    "options_hi": ["Na2O", "CaO", "Al2O3", "CO"],
    "answer_en": "Al2O3",
    "answer_hi": "Al2O3",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 2,
    "question_en": "Which halogen has the highest electron affinity?",
    "question_hi": "किस हैलोजन की इलेक्ट्रॉन अभिलाषा सबसे अधिक होती है?",
    "options_en": ["Cl", "Br", "I", "F"],
    "options_hi": ["Cl", "Br", "I", "F"],
    "answer_en": "Cl",
    "answer_hi": "Cl",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 3,
    "question_en": "Which of the following is a biodegradable polymer?",
    "question_hi": "निम्न में से कौन सा एक बायोडिग्रेडेबल पॉलिमर है?",
    "options_en": ["Nylon-6", "Polyethene", "PHBV", "PVC"],
    "options_hi": ["Nylon-6", "Polyethene", "PHBV", "PVC"],
    "answer_en": "PHBV",
    "answer_hi": "PHBV",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 4,
    "question_en": "Which metal is extracted by the Hall–Héroult process?",
    "question_hi": "हॉल–हेरोल्ट प्रक्रिया से किस धातु का निष्कर्षण किया जाता है?",
    "options_en": ["Cu", "Al", "Fe", "Zn"],
    "options_hi": ["Cu", "Al", "Fe", "Zn"],
    "answer_en": "Al",
    "answer_hi": "Al",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 5,
    "question_en": "Which of the following is used as an antiseptic?",
    "question_hi": "निम्न में से कौन एंटीसेप्टिक के रूप में उपयोग होता है?",
    "options_en": ["Iodoform", "Chloroform", "Carbon tetrachloride", "Ethane"],
    "options_hi": ["Iodoform", "Chloroform", "Carbon tetrachloride", "Ethane"],
    "answer_en": "Iodoform",
    "answer_hi": "Iodoform",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 6,
    "question_en": "Which of the following forms a complex ion [Ag(NH3)2]+?",
    "question_hi": "निम्न में से कौन [Ag(NH3)2]+ कॉम्प्लेक्स बनाता है?",
    "options_en": ["NH3", "Cl−", "OH−", "CO3²−"],
    "options_hi": ["NH3", "Cl−", "OH−", "CO3²−"],
    "answer_en": "NH3",
    "answer_hi": "NH3",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 7,
    "question_en": "Which gas is used in manufacture of HNO3 by Ostwald process?",
    "question_hi": "ओस्टवाल्ड प्रक्रिया द्वारा HNO3 के निर्माण में कौन सी गैस प्रयोग होती है?",
    "options_en": ["CO", "NO", "N2O", "NO2"],
    "options_hi": ["CO", "NO", "N2O", "NO2"],
    "answer_en": "NO",
    "answer_hi": "NO",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 8,
    "question_en": "Which is the strongest acid?",
    "question_hi": "सबसे प्रबल अम्ल कौन सा है?",
    "options_en": ["H2SO4", "HClO4", "HNO3", "H3PO4"],
    "options_hi": ["H2SO4", "HClO4", "HNO3", "H3PO4"],
    "answer_en": "HClO4",
    "answer_hi": "HClO4",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 9,
    "question_en": "Which of the following has sp hybridisation?",
    "question_hi": "निम्न में से किसमें sp हाइब्रिडीकरण होता है?",
    "options_en": ["CO2", "BF3", "NH3", "CH4"],
    "options_hi": ["CO2", "BF3", "NH3", "CH4"],
    "answer_en": "CO2",
    "answer_hi": "CO2",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 10,
    "question_en": "Which process is used for concentration of sulphide ores?",
    "question_hi": "सल्फाइड अयस्कों के सांद्रीकरण हेतु कौन सी विधि प्रयोग की जाती है?",
    "options_en": ["Froth flotation", "Gravity separation", "Leaching", "Magnetic separation"],
    "options_hi": ["Froth flotation", "Gravity separation", "Leaching", "Magnetic separation"],
    "answer_en": "Froth flotation",
    "answer_hi": "Froth flotation",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 11,
    "question_en": "Which vitamin is known as ascorbic acid?",
    "question_hi": "अस्कॉर्बिक अम्ल किस विटामिन को कहते हैं?",
    "options_en": ["Vitamin A", "Vitamin C", "Vitamin D", "Vitamin K"],
    "options_hi": ["Vitamin A", "Vitamin C", "Vitamin D", "Vitamin K"],
    "answer_en": "Vitamin C",
    "answer_hi": "Vitamin C",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 12,
    "question_en": "Which alloy contains copper and zinc?",
    "question_hi": "कौन सा मिश्रधातु तांबा और जस्ता से बनता है?",
    "options_en": ["Bronze", "Brass", "Duralumin", "Solder"],
    "options_hi": ["Bronze", "Brass", "Duralumin", "Solder"],
    "answer_en": "Brass",
    "answer_hi": "Brass",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 13,
    "question_en": "Which enzyme converts starch into maltose?",
    "question_hi": "कौन सा एंजाइम स्टार्च को माल्टोज़ में बदलता है?",
    "options_en": ["Invertase", "Zymase", "Maltase", "Amylase"],
    "options_hi": ["Invertase", "Zymase", "Maltase", "Amylase"],
    "answer_en": "Amylase",
    "answer_hi": "Amylase",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 14,
    "question_en": "Which of the following is π–π* transition?",
    "question_hi": "निम्न में से किसमें π–π* संक्रमण होता है?",
    "options_en": ["Alkanes", "Alkenes", "Alkynes", "Saturated hydrocarbons"],
    "options_hi": ["Alkanes", "Alkenes", "Alkynes", "Saturated hydrocarbons"],
    "answer_en": "Alkenes",
    "answer_hi": "Alkenes",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 15,
    "question_en": "Which is NOT a colligative property?",
    "question_hi": "निम्न में से कौन कोलिगेटिव गुण नहीं है?",
    "options_en": ["Osmotic pressure", "Boiling point elevation", "Freezing point depression", "Density"],
    "options_hi": ["Osmotic pressure", "Boiling point elevation", "Freezing point depression", "Density"],
    "answer_en": "Density",
    "answer_hi": "Density",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 16,
    "question_en": "Which of the following is a noble gas compound?",
    "question_hi": "निम्न में से कौन उदासीन गैस का यौगिक है?",
    "options_en": ["XeF2", "ArCl", "HeF2", "NeCl"],
    "options_hi": ["XeF2", "ArCl", "HeF2", "NeCl"],
    "answer_en": "XeF2",
    "answer_hi": "XeF2",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 17,
    "question_en": "Which among the following is an aniline derivative?",
    "question_hi": "निम्न में से कौन ऐनिलीन का व्युत्पन्न है?",
    "options_en": ["C6H5NH2", "C6H6", "C6H5NO2", "C6H5Cl"],
    "options_hi": ["C6H5NH2", "C6H6", "C6H5NO2", "C6H5Cl"],
    "answer_en": "C6H5NH2",
    "answer_hi": "C6H5NH2",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 18,
    "question_en": "Which metal reacts vigorously with cold water?",
    "question_hi": "कौन सी धातु ठंडे पानी से तीव्रता से अभिक्रिया करती है?",
    "options_en": ["Mg", "Al", "Na", "Zn"],
    "options_hi": ["Mg", "Al", "Na", "Zn"],
    "answer_en": "Na",
    "answer_hi": "Na",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 19,
    "question_en": "Which gas is colourless and odourless?",
    "question_hi": "कौन सी गैस रंगहीन और गंधहीन होती है?",
    "options_en": ["O3", "Cl2", "NH3", "O2"],
    "options_hi": ["O3", "Cl2", "NH3", "O2"],
    "answer_en": "O2",
    "answer_hi": "O2",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 20,
    "question_en": "Which of the following obeys Henry’s law?",
    "question_hi": "निम्न में से कौन हेनरी का नियम मानता है?",
    "options_en": ["Solids in solids", "Gases in liquids", "Liquids in solids", "Solids in liquids"],
    "options_hi": ["Solids in solids", "Gases in liquids", "Liquids in solids", "Solids in liquids"],
    "answer_en": "Gases in liquids",
    "answer_hi": "Gases in liquids",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 21,
    "question_en": "Which reagent distinguishes aldehydes from ketones?",
    "question_hi": "कौन सा अभिकर्मक ऐल्डिहाइड को कीटोन से पहचानता है?",
    "options_en": ["Fehling’s solution", "Tollen’s reagent", "Grignard reagent", "Lucas reagent"],
    "options_hi": ["Fehling’s solution", "Tollen’s reagent", "Grignard reagent", "Lucas reagent"],
    "answer_en": "Tollen’s reagent",
    "answer_hi": "Tollen’s reagent",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 22,
    "question_en": "Which compound is used to prepare nylon?",
    "question_hi": "नायलॉन बनाने में कौन सा यौगिक उपयोग होता है?",
    "options_en": ["Phenol", "Caprolactam", "Acetone", "Acetic acid"],
    "options_hi": ["Phenol", "Caprolactam", "Acetone", "Acetic acid"],
    "answer_en": "Caprolactam",
    "answer_hi": "Caprolactam",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 23,
    "question_en": "Which is the hardest form of carbon?",
    "question_hi": "कार्बन का सबसे कठोर रूप कौन सा है?",
    "options_en": ["Graphite", "Diamond", "Fullerene", "Coal"],
    "options_hi": ["Graphite", "Diamond", "Fullerene", "Coal"],
    "answer_en": "Diamond",
    "answer_hi": "Diamond",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 24,
    "question_en": "Which of the following has highest boiling point?",
    "question_hi": "निम्न में से किसका क्वथनांक सबसे अधिक है?",
    "options_en": ["CH4", "C2H6", "C3H8", "C4H10"],
    "options_hi": ["CH4", "C2H6", "C3H8", "C4H10"],
    "answer_en": "C4H10",
    "answer_hi": "C4H10",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 25,
    "question_en": "Which acid is present in vinegar?",
    "question_hi": "सिरके में कौन सा अम्ल पाया जाता है?",
    "options_en": ["Formic acid", "Acetic acid", "Citric acid", "Oxalic acid"],
    "options_hi": ["Formic acid", "Acetic acid", "Citric acid", "Oxalic acid"],
    "answer_en": "Acetic acid",
    "answer_hi": "Acetic acid",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 26,
    "question_en": "Which compound shows optical isomerism?",
    "question_hi": "कौन सा यौगिक प्रकाशीय समावयवता दर्शाता है?",
    "options_en": ["CH3CH2Cl", "CH3CHO", "CHClBrFI", "CH4"],
    "options_hi": ["CH3CH2Cl", "CH3CHO", "CHClBrFI", "CH4"],
    "answer_en": "CHClBrFI",
    "answer_hi": "CHClBrFI",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 27,
    "question_en": "Which species is planar?",
    "question_hi": "कौन सी प्रजाति समतलीय है?",
    "options_en": ["NH3", "BF3", "CH4", "H2O"],
    "options_hi": ["NH3", "BF3", "CH4", "H2O"],
    "answer_en": "BF3",
    "answer_hi": "BF3",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 28,
    "question_en": "Which among the following is a Lewis base?",
    "question_hi": "निम्न में से कौन लुईस क्षार है?",
    "options_en": ["BF3", "AlCl3", "NH3", "H+"],
    "options_hi": ["BF3", "AlCl3", "NH3", "H+"],
    "answer_en": "NH3",
    "answer_hi": "NH3",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 29,
    "question_en": "Which of the following is used in photography?",
    "question_hi": "फोटोग्राफी में कौन सा यौगिक उपयोग होता है?",
    "options_en": ["AgBr", "CuSO4", "ZnO", "BaSO4"],
    "options_hi": ["AgBr", "CuSO4", "ZnO", "BaSO4"],
    "answer_en": "AgBr",
    "answer_hi": "AgBr",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 30,
    "question_en": "Which of the following has maximum conductivity?",
    "question_hi": "निम्न में से किसकी चालकता सबसे अधिक है?",
    "options_en": ["NaCl(s)", "NaCl(aq)", "CCl4", "Sugar solution"],
    "options_hi": ["NaCl(s)", "NaCl(aq)", "CCl4", "Sugar solution"],
    "answer_en": "NaCl(aq)",
    "answer_hi": "NaCl(aq)",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 31,
    "question_en": "Which element forms +7 oxidation state?",
    "question_hi": "कौन सा तत्व +7 ऑक्सीकरण अवस्था बनाता है?",
    "options_en": ["Mn", "Fe", "Cu", "Zn"],
    "options_hi": ["Mn", "Fe", "Cu", "Zn"],
    "answer_en": "Mn",
    "answer_hi": "Mn",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 32,
    "question_en": "Which of the following is not an alloy?",
    "question_hi": "निम्न में से कौन मिश्रधातु नहीं है?",
    "options_en": ["Steel", "Brass", "Bronze", "Quartz"],
    "options_hi": ["Steel", "Brass", "Bronze", "Quartz"],
    "answer_en": "Quartz",
    "answer_hi": "Quartz",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 33,
    "question_en": "Which among the following is a greenhouse gas?",
    "question_hi": "निम्न में से कौन ग्रीनहाउस गैस है?",
    "options_en": ["N2", "O2", "CH4", "Ar"],
    "options_hi": ["N2", "O2", "CH4", "Ar"],
    "answer_en": "CH4",
    "answer_hi": "CH4",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 34,
    "question_en": "Which is an example of endothermic reaction?",
    "question_hi": "निम्न में से कौन उष्माशोषी अभिक्रिया का उदाहरण है?",
    "options_en": ["Combustion", "Photosynthesis", "Neutralisation", "Respiration"],
    "options_hi": ["Combustion", "Photosynthesis", "Neutralisation", "Respiration"],
    "answer_en": "Photosynthesis",
    "answer_hi": "Photosynthesis",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 35,
    "question_en": "Which of the following has maximum lattice energy?",
    "question_hi": "निम्न में से किसका जाली ऊर्जा सबसे अधिक है?",
    "options_en": ["NaCl", "MgO", "KCl", "CaO"],
    "options_hi": ["NaCl", "MgO", "KCl", "CaO"],
    "answer_en": "MgO",
    "answer_hi": "MgO",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 36,
    "question_en": "Which is a non–renewable source of energy?",
    "question_hi": "कौन सा ऊर्जा स्रोत अक्षय नहीं है?",
    "options_en": ["Wind", "Solar", "Coal", "Hydro"],
    "options_hi": ["Wind", "Solar", "Coal", "Hydro"],
    "answer_en": "Coal",
    "answer_hi": "Coal",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 37,
    "question_en": "Which of the following forms coloured ions?",
    "question_hi": "निम्न में से कौन रंगीन आयन बनाता है?",
    "options_en": ["Zn2+", "Cu2+", "Al3+", "Mg2+"],
    "options_hi": ["Zn2+", "Cu2+", "Al3+", "Mg2+"],
    "answer_en": "Cu2+",
    "answer_hi": "Cu2+",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 38,
    "question_en": "Which element shows inert pair effect?",
    "question_hi": "कौन सा तत्व इनर्ट पेयर प्रभाव दिखाता है?",
    "options_en": ["Mg", "C", "Sn", "O"],
    "options_hi": ["Mg", "C", "Sn", "O"],
    "answer_en": "Sn",
    "answer_hi": "Sn",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 39,
    "question_en": "Which among these is an organometallic compound?",
    "question_hi": "निम्न में से कौन ऑर्गेनोमेटैलिक यौगिक है?",
    "options_en": ["CH3MgBr", "NaCl", "CaCO3", "Al2O3"],
    "options_hi": ["CH3MgBr", "NaCl", "CaCO3", "Al2O3"],
    "answer_en": "CH3MgBr",
    "answer_hi": "CH3MgBr",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 40,
    "question_en": "Which reaction forms polyester?",
    "question_hi": "कौन सी अभिक्रिया पॉलिएस्टर बनाती है?",
    "options_en": ["Addition polymerisation", "Condensation polymerisation", "Substitution", "Elimination"],
    "options_hi": ["Addition polymerisation", "Condensation polymerisation", "Substitution", "Elimination"],
    "answer_en": "Condensation polymerisation",
    "answer_hi": "Condensation polymerisation",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 41,
    "question_en": "Which among the following is a buffer solution?",
    "question_hi": "निम्न में से कौन बफ़र विलयन है?",
    "options_en": ["HCl + NaCl", "CH3COOH + CH3COONa", "NaOH + NaCl", "KNO3"],
    "options_hi": ["HCl + NaCl", "CH3COOH + CH3COONa", "NaOH + NaCl", "KNO3"],
    "answer_en": "CH3COOH + CH3COONa",
    "answer_hi": "CH3COOH + CH3COONa",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 42,
    "question_en": "Which oxide is most basic?",
    "question_hi": "कौन सा ऑक्साइड सबसे अधिक क्षारीय है?",
    "options_en": ["Na2O", "MgO", "Al2O3", "SiO2"],
    "options_hi": ["Na2O", "MgO", "Al2O3", "SiO2"],
    "answer_en": "Na2O",
    "answer_hi": "Na2O",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 43,
    "question_en": "Which gas is used for artificial ripening of fruits?",
    "question_hi": "फलों के कृत्रिम पकाने में कौन सी गैस उपयोग होती है?",
    "options_en": ["CO2", "C2H4", "O3", "N2"],
    "options_hi": ["CO2", "C2H4", "O3", "N2"],
    "answer_en": "C2H4",
    "answer_hi": "C2H4",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 44,
    "question_en": "Which of the following is used as a refrigerant?",
    "question_hi": "कौन सा पदार्थ रेफ्रिजरेंट के रूप में उपयोग होता है?",
    "options_en": ["Freon-12", "Chloroform", "Benzene", "Ether"],
    "options_hi": ["Freon-12", "Chloroform", "Benzene", "Ether"],
    "answer_en": "Freon-12",
    "answer_hi": "Freon-12",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 45,
    "question_en": "Which bond has the highest bond energy?",
    "question_hi": "कौन सा बंध सबसे अधिक बंध ऊर्जा रखता है?",
    "options_en": ["C–C", "C=C", "C≡C", "C–H"],
    "options_hi": ["C–C", "C=C", "C≡C", "C–H"],
    "answer_en": "C≡C",
    "answer_hi": "C≡C",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 46,
    "question_en": "Which of these is a zwitterion?",
    "question_hi": "निम्न में से कौन ज़्विटर आयन है?",
    "options_en": ["Glycine", "Acetone", "Acetic acid", "Methanol"],
    "options_hi": ["Glycine", "Acetone", "Acetic acid", "Methanol"],
    "answer_en": "Glycine",
    "answer_hi": "Glycine",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 47,
    "question_en": "Which is the major product of dehydration of ethanol?",
    "question_hi": "एथेनॉल के निर्जलीकरण का मुख्य उत्पाद क्या है?",
    "options_en": ["Methane", "Ethene", "Ethane", "Acetylene"],
    "options_hi": ["Methane", "Ethene", "Ethane", "Acetylene"],
    "answer_en": "Ethene",
    "answer_hi": "Ethene",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 48,
    "question_en": "Which of the following acts as an oxidising agent?",
    "question_hi": "निम्न में से कौन ऑक्सीकारक के रूप में कार्य करता है?",
    "options_en": ["H2", "SO2", "KMnO4", "H2S"],
    "options_hi": ["H2", "SO2", "KMnO4", "H2S"],
    "answer_en": "KMnO4",
    "answer_hi": "KMnO4",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 49,
    "question_en": "Which ion imparts a brick-red flame?",
    "question_hi": "कौन सा आयन ईंट-लाल ज्वाला देता है?",
    "options_en": ["Na+", "K+", "Ca2+", "Sr2+"],
    "options_hi": ["Na+", "K+", "Ca2+", "Sr2+"],
    "answer_en": "Ca2+",
    "answer_hi": "Ca2+",
    "attempted": false,
    "selected": ""
  },

  {
    "num": 50,
    "question_en": "Which functional group is present in ketones?",
    "question_hi": "कीटोन में कौन सा क्रियात्मक समूह पाया जाता है?",
    "options_en": ["–CHO", "–CO–", "–OH", "–COOH"],
    "options_hi": ["–CHO", "–CO–", "–OH", "–COOH"],
    "answer_en": "–CO–",
    "answer_hi": "–CO–",
    "attempted": false,
    "selected": ""
  }
];




let currentQuestion = 0;
let language = "en";
let timeLeft = 60 * 60; 
let timerInterval;

// ----------------- Load Question -----------------
function loadQuestion(index) {
    const q = questions[index];
    if (!q) return; //  undefined error fix
   questions[index].visited = true;
    document.getElementById("question").textContent =
       `${q.num}. ${language === "en" ? q.question_en : q.question_hi}`;

    document.getElementById("questionCounter").textContent =
       ` Question ${index + 1} of ${questions.length}`;

    const optionsElement = document.getElementById("options");
    optionsElement.innerHTML = "";

    const options = language === "en" ? q.options_en : q.options_hi;

    options.forEach(option => {
        const isSelected = q.selected === option;

        const div = document.createElement("div");
        div.className = "option-box";

        div.style = `
            border: 2px solid ${isSelected ? "#007bff" : "#ccc"};
            background-color: ${isSelected ? "#e7f1ff" : "white"};
            padding: 10px;
            border-radius: 8px;
            margin: 6px 0;
            cursor: pointer;
        `;

        div.innerHTML = `
            <input type="radio" name="option" value="${option}" 
            ${isSelected ? "checked" : ""} style="margin-right:8px;">
            ${option}
        `;

        div.addEventListener("click", () => {
            markAttempted(index, option);
            loadQuestion(index);
        });

        optionsElement.appendChild(div);
    });

    updateNavigation();
}

// ----------------- Attempt Mark -----------------
function markAttempted(index, selectedAnswer) {
    questions[index].attempted = true;
    questions[index].selected = selectedAnswer;
    updateNavigation();
}

// ----------------- Next / Previous -----------------
function nextQuestion() {
    if (currentQuestion < questions.length - 1) {
        currentQuestion++;
        loadQuestion(currentQuestion);
    }
}

function prevQuestion() {
    if (currentQuestion > 0) {
        currentQuestion--;
        loadQuestion(currentQuestion);
    }
}

function changeLanguage() {
    language = document.getElementById("languageSelect").value;
    loadQuestion(currentQuestion);
}

// ----------------- Final Submit -----------------
function submitQuiz() {
    let confirmation = confirm("Are you sure you want to submit the test?");
    if (!confirmation) return;

    let attempted = 0;
    let notAttempted = 0;
    let score = 0;
    const results = [];

    questions.forEach(q => {
        if (q.attempted) {
            attempted++;

            if (q.selected === q.answer_en || q.selected === q.answer_hi) {
                score++;
            }
        } else {
            notAttempted++;
        }

        results.push({
            question: language === "en" ? q.question_en : q.question_hi,
            selected: q.selected || "Not Answered",
            correct: language === "en" ? q.answer_en : q.answer_hi
        });
    });

    localStorage.setItem("attempted", attempted);
    localStorage.setItem("notAttempted", notAttempted);
    localStorage.setItem("score", score);
    localStorage.setItem("results", JSON.stringify(results));

    let viewResult = confirm("Test submitted! Do you want to view result?");
    if (viewResult) {
        window.location.href = "/RTS/public/Deshbord/category/test/submit-test.html";
    }
}

// ----------------- Navigation Circles -----------------
function updateNavigation() {
    const nav = document.getElementById("circleContainer");
    nav.innerHTML = "";

    questions.forEach((q, i) => {
        let color = "gray"; // default: not visited

        if (i === currentQuestion) {
            color = "blue"; // current question
        } 
        else if (q.attempted) {
            color = "green"; // answered
        } 
        else if (q.visited) {
            color = "white"; // visited but not answered
        }

        nav.innerHTML += `
            <div class="circle" style="background:${color}; border:1px solid black;"
            onclick="jumpToQuestion(${i})">${i + 1}</div>
        `;
    });
}

function jumpToQuestion(index) {
    currentQuestion = index;
    loadQuestion(index);
}

// ----------------- Timer -----------------
function startTimer() {
    const timerElement = document.getElementById("timer");

    timerInterval = setInterval(() => {
        if (timeLeft <= 0) {
            clearInterval(timerInterval);
            alert("Time's up!");
            submitQuiz();
        } else {
            const hours = String(Math.floor(timeLeft / 3600)).padStart(2, "0");
            const minutes = String(Math.floor((timeLeft % 3600) / 60)).padStart(2, "0");
            const seconds = String(timeLeft % 60).padStart(2, "0");

            timerElement.textContent = `Time Left: ${hours}:${minutes}:${seconds}`;
            timeLeft--;
        }
    }, 1000);
}

// ----------------- Camera & Movement Detection -----------------
let videoStream;
let movementCount = 0;

function startCamera() {
    const container = document.createElement("div");
    container.id = "camera-container";
    container.style = `
        position:fixed; top:10px; left:10px; width:130px; height:130px;
        border-radius:50%; overflow:hidden; border:3px solid red; z-index:9999;
    `;

    document.body.appendChild(container);

    const video = document.createElement("video");
    video.autoplay = true;
    video.playsinline = true;
    video.style = "width:100%; height:100%; object-fit:cover;";
    container.appendChild(video);

    navigator.mediaDevices.getUserMedia({ video: true })
        .then(stream => {
            video.srcObject = stream;
            videoStream = stream;
            detectMovement(video);
        })
        .catch(() => alert("Camera access denied!"));
}

function detectMovement(video) {
    const canvas = document.createElement("canvas");
    const ctx = canvas.getContext("2d");
    canvas.width = 160;
    canvas.height = 160;

    let lastData = null;

    setInterval(() => {
        ctx.drawImage(video, 0, 0, 160, 160);
        const data = ctx.getImageData(0, 0, 160, 160);

        if (lastData) {
            let diff = 0;
            for (let i = 0; i < data.data.length; i += 4) {
                diff += Math.abs(data.data[i] - lastData.data[i]);
            }

            if (diff > 1000000) {
                movementCount++;

                if (movementCount === 1) alert("⚠ Alert 1: No movement detected!");
                if (movementCount === 2) alert("⚠ Alert 2: Head not moving!");
                if (movementCount === 3) {
                    alert("⚠ Alert 3: Restarting test...");
                    restartTest();
                }
            }
        }
        lastData = data;

    }, 2000);
}

function restartTest() {
    if (videoStream) videoStream.getTracks().forEach(t => t.stop());

    const cam = document.getElementById("camera-container");
    if (cam) cam.remove();

    movementCount = 0;
    currentQuestion = 0;
    timeLeft = 60 * 60;

    questions.forEach(q => {
        q.attempted = false;
        q.selected = null;
    });

    loadQuestion(0);
    startTimer();
    startCamera();
}

// ----------------- Page Load -----------------
window.onload = function () {
    loadQuestion(currentQuestion);
    startTimer();
    startCamera();
};