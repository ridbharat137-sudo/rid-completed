const questions= [
 {
    "num": 1,
    "question_en": "What is 'study' contrasted with in the poem?",
    "options_en": ["Work", "Sleep", "Ease", "Business"],
    "answer_en": "Business",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 2,
    "question_en": "What does 'hours' refer to?",
    "options_en": ["Clock time", "Time passing", "Work shifts", "Prayer times"],
    "answer_en": "Time passing",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 3,
    "question_en": "How should the poet's days be?",
    "options_en": ["Long and boring", "Short and sweet", "Full of activity", "Empty"],
    "answer_en": "Short and sweet",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 4,
    "question_en": "What does the poet want to inherit?",
    "options_en": ["A kingdom", "His father's land", "A fortune", "A title"],
    "answer_en": "His father's land",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 5,
    "question_en": "What does the poet mean by 'paternal acres'?",
    "options_en": ["Land from mother", "Land inherited from father", "Purchased land", "Rented property"],
    "answer_en": "Land inherited from father",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 6,
    "question_en": "What should the land provide for the poet?",
    "options_en": ["Wealth for luxury", "Just enough for needs", "Excess for storage", "Nothing at all"],
    "answer_en": "Just enough for needs",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 7,
    "question_en": "What does 'wholesome' mean in the context of the poem?",
    "options_en": ["Medicinal", "Healthful and good", "Expensive", "Artificial"],
    "answer_en": "Healthful and good",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 8,
    "question_en": "Where should the poet's herds provide milk?",
    "options_en": ["From the market", "From the fields", "From factories", "From abroad"],
    "answer_en": "From the fields",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 9,
    "question_en": "What should the poet's fields provide?",
    "options_en": ["Cash crops", "Bread and attire", "Export goods", "Decorative plants"],
    "answer_en": "Bread and attire",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 10,
    "question_en": "What does 'attire' refer to in the poem?",
    "options_en": ["Fashionable clothes", "Clothing from fields", "Uniforms", "Jewelry"],
    "answer_en": "Clothing from fields",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 11,
    "question_en": "How many hours of sleep does the poet desire?",
    "options_en": ["Four hours", "Six hours", "Sound sleep", "No sleep"],
    "answer_en": "Sound sleep",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 12,
    "question_en": "What does the poet want his sleep to be like?",
    "options_en": ["Disturbed", "Sound", "Short", "Medicated"],
    "answer_en": "Sound",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 13,
    "question_en": "How does the poet want to spend his time?",
    "options_en": ["In meditation", "In study", "In ease", "In hard labor"],
    "answer_en": "In ease",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 14,
    "question_en": "What should the poet's hours be?",
    "options_en": ["Careful and slow", "Swift and easy", "Busy and fast", "Monotonous"],
    "answer_en": "Swift and easy",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 15,
    "question_en": "What does the poet mean by 'study'?",
    "options_en": ["Formal education", "Self-reflection", "Business studies", "Scientific research"],
    "answer_en": "Self-reflection",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 16,
    "question_en": "Where does the poet want to live unseen?",
    "options_en": ["In a cave", "In his retreat", "In a monastery", "In a forest"],
    "answer_en": "In his retreat",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 17,
    "question_en": "What does the poet want to die?",
    "options_en": ["Famous", "Unlamented", "Wealthy", "Regretted"],
    "answer_en": "Unlamented",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 18,
    "question_en": "What should not be carved on the poet's tombstone?",
    "options_en": ["His name", "A cross", "A stone", "A lie"],
    "answer_en": "A stone",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 19,
    "question_en": "What should not be on the poet's grave?",
    "options_en": ["Flowers", "A stone", "Grass", "A fence"],
    "answer_en": "A stone",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 20,
    "question_en": "What kind of life does the poem celebrate?",
    "options_en": ["Urban life", "Solitary rural life", "Courtly life", "Adventurous life"],
    "answer_en": "Solitary rural life",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 21,
    "question_en": "What is the central theme of the ode?",
    "options_en": ["Wealth accumulation", "Contentment in solitude", "Political power", "Social fame"],
    "answer_en": "Contentment in solitude",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 22,
    "question_en": "What does the poet value over public acclaim?",
    "options_en": ["Anonymity", "Wealth", "Power", "Popularity"],
    "answer_en": "Anonymity",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 23,
    "question_en": "What does 'blest' mean in the poem?",
    "options_en": ["Cursed", "Blessed/happy", "Rich", "Famous"],
    "answer_en": "Blessed/happy",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 24,
    "question_en": "Who can be truly happy according to the poem?",
    "options_en": ["The wealthy man", "The solitary man", "The king", "The scholar"],
    "answer_en": "The solitary man",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 25,
    "question_en": "What does the poet wish to be free from?",
    "options_en": ["Work", "Society's expectations", "Family", "Nature"],
    "answer_en": "Society's expectations",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 26,
    "question_en": "What is 'innocence' in the context of the poem?",
    "options_en": ["Freedom from sin", "Simplicity of life", "Ignorance", "Childishness"],
    "answer_en": "Simplicity of life",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 27,
    "question_en": "How does the poet view meditation?",
    "options_en": ["As a chore", "As a pleasure", "As religious duty", "As unnecessary"],
    "answer_en": "As a pleasure",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 28,
    "question_en": "What does the poet mean by 'retreat'?",
    "options_en": ["Military withdrawal", "Secluded place", "Vacation spot", "Monastery"],
    "answer_en": "Secluded place",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 29,
    "question_en": "What should the poet's death be?",
    "options_en": ["Mourned by all", "Unnoticed", "Celebrated", "Feared"],
    "answer_en": "Unnoticed",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 30,
    "question_en": "What is the poet's attitude toward fame?",
    "options_en": ["Seeks it eagerly", "Despises it", "Ignores it", "Fears it"],
    "answer_en": "Ignores it",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 31,
    "question_en": "What does 'paternal' refer to?",
    "options_en": ["Mother's side", "Father's side", "Government's", "Community's"],
    "answer_en": "Father's side",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 32,
    "question_en": "How should time pass for the poet?",
    "options_en": ["Slowly", "Swiftly", "Painfully", "Unnoticed"],
    "answer_en": "Swiftly",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 33,
    "question_en": "What does the poet study?",
    "options_en": ["Himself", "Others", "Nature", "Books"],
    "answer_en": "Himself",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 34,
    "question_en": "What does 'ease' mean in the poem?",
    "options_en": ["Laziness", "Comfortable leisure", "Wealth", "Sleep"],
    "answer_en": "Comfortable leisure",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 35,
    "question_en": "What kind of death is desirable?",
    "options_en": ["A public death", "A private death", "A heroic death", "A sudden death"],
    "answer_en": "A private death",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 36,
    "question_en": "What should mark the poet's grave?",
    "options_en": ["A grand monument", "Nothing", "A simple cross", "A poem"],
    "answer_en": "Nothing",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 37,
    "question_en": "What is the poet's view of worldly success?",
    "options_en": ["Essential", "Unimportant", "Dangerous", "Temporary"],
    "answer_en": "Unimportant",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 38,
    "question_en": "How many acres does the poet desire?",
    "options_en": ["As many as possible", "Just a few", "None", "Hundreds"],
    "answer_en": "Just a few",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 39,
    "question_en": "What does the poet mean by 'native air'?",
    "options_en": ["Homeland", "Fresh air", "Mountain air", "Sea air"],
    "answer_en": "Homeland",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 40,
    "question_en": "What provides the poet's food?",
    "options_en": ["Markets", "His herds and fields", "Restaurants", "Hunting"],
    "answer_en": "His herds and fields",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 41,
    "question_en": "What does 'health of body' come from?",
    "options_en": ["Medicine", "Wholesome food", "Exercise", "Doctors"],
    "answer_en": "Wholesome food",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 42,
    "question_en": "What does 'peace of mind' come from?",
    "options_en": ["Wealth", "Solitude", "Friends", "Religion"],
    "answer_en": "Solitude",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 43,
    "question_en": "What does the poet do during the day?",
    "options_en": ["Works hard", "Meditates and rests", "Socializes", "Travels"],
    "answer_en": "Meditates and rests",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 44,
    "question_en": "What is the poet's 'book'?",
    "options_en": ["His own mind", "A physical book", "Nature", "The Bible"],
    "answer_en": "His own mind",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 45,
    "question_en": "What does 'live unseen' mean?",
    "options_en": ["Become invisible", "Live in obscurity", "Hide from law", "Live in darkness"],
    "answer_en": "Live in obscurity",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 46,
    "question_en": "What does the poet not want after death?",
    "options_en": ["Peace", "To be remembered", "To be forgotten", "A funeral"],
    "answer_en": "To be remembered",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 47,
    "question_en": "What is the tone of the poem?",
    "options_en": ["Angry", "Content and peaceful", "Sad", "Excited"],
    "answer_en": "Content and peaceful",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 48,
    "question_en": "What does 'solitude' mean in the poem?",
    "options_en": ["Loneliness", "Peaceful aloneness", "Isolation", "Boredom"],
    "answer_en": "Peaceful aloneness",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 49,
    "question_en": "What is the opposite of the life the poet desires?",
    "options_en": ["Rural life", "Urban busy life", "Religious life", "Family life"],
    "answer_en": "Urban busy life",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 50,
    "question_en": "What does the poet mean by 'unlamented'?",
    "options_en": ["Without mourning", "Unloved", "Unimportant", "Unsuccessful"],
    "answer_en": "Without mourning",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 51,
    "question_en": "How does the poet view sleep?",
    "options_en": ["As waste of time", "As necessary rest", "As escape", "As unimportant"],
    "answer_en": "As necessary rest",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 52,
    "question_en": "What does 'attire' come from?",
    "options_en": ["Sheep's wool", "Silk worms", "Cotton plants", "All of these"],
    "answer_en": "All of these",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 53,
    "question_en": "What is 'meditation' for the poet?",
    "options_en": ["Religious prayer", "Thoughtful reflection", "Daydreaming", "Sleeping"],
    "answer_en": "Thoughtful reflection",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 54,
    "question_en": "What does the poet not need from society?",
    "options_en": ["Anything", "Recognition", "Goods", "Services"],
    "answer_en": "Recognition",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 55,
    "question_en": "How should the poet's life be measured?",
    "options_en": ["By achievements", "By years", "By contentment", "By wealth"],
    "answer_en": "By contentment",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 56,
    "question_en": "What does 'sound sleep' imply?",
    "options_en": ["Loud snoring", "Undisturbed rest", "Short nap", "Medicated sleep"],
    "answer_en": "Undisturbed rest",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 57,
    "question_en": "What is the poet's source of happiness?",
    "options_en": ["External things", "Inner peace", "Other people", "Future hopes"],
    "answer_en": "Inner peace",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 58,
    "question_en": "What does 'breath' represent in the poem?",
    "options_en": ["Life itself", "Air quality", "Speaking", "Singing"],
    "answer_en": "Life itself",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 59,
    "question_en": "How does the poet want to die?",
    "options_en": ["In battle", "In sleep", "Suddenly", "Peacefully"],
    "answer_en": "Peacefully",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 60,
    "question_en": "What does the poet reject?",
    "options_en": ["Nature", "Materialism", "Family", "Health"],
    "answer_en": "Materialism",
    "attempted": false,
    "selected": ""
  },
   {
    "num": 61,
    "question_en": "Who is the poet of 'Ode on Solitude'?",
    "options_en": ["William Wordsworth", "Alexander Pope", "John Keats", "William Blake"],
    "answer_en": "Alexander Pope",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 62,
    "question_en": "What does the poet wish for in solitude?",
    "options_en": ["Wealth and fame", "A few paternal acres", "A palace", "A large city"],
    "answer_en": "A few paternal acres",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 63,
    "question_en": "Where does the poet want to live according to the poem?",
    "options_en": ["In a bustling city", "In his native air", "In a foreign land", "In a royal court"],
    "answer_en": "In his native air",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 64,
    "question_en": "What does 'innocence' protect from?",
    "options_en": ["Crime", "Worldly corruption", "Disease", "Poverty"],
    "answer_en": "Worldly corruption",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 65,
    "question_en": "What is the poet's greatest fear?",
    "options_en": ["Poverty", "Being forgotten", "Losing solitude", "Fame"],
    "answer_en": "Fame",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 66,
    "question_en": "What does the poet mean by 'quiet by day'?",
    "options_en": ["Silent days", "Peaceful days", "Busy days", "Loud days"],
    "answer_en": "Peaceful days",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 67,
    "question_en": "How does the poet view night?",
    "options_en": ["With fear", "For sound sleep", "For work", "For socializing"],
    "answer_en": "For sound sleep",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 68,
    "question_en": "What is 'labor' in the context?",
    "options_en": ["Hard work", "Simple farming", "Office work", "Artistic work"],
    "answer_en": "Simple farming",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 69,
    "question_en": "What does 'content' mean?",
    "options_en": ["Satisfied", "Angry", "Wealthy", "Famous"],
    "answer_en": "Satisfied",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 70,
    "question_en": "What does the poet not seek?",
    "options_en": ["Knowledge", "Immortality", "Comfort", "Peace"],
    "answer_en": "Immortality",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 71,
    "question_en": "How should the poet's death be recorded?",
    "options_en": ["In history books", "Nowhere", "In poetry", "In family records"],
    "answer_en": "Nowhere",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 72,
    "question_en": "What does 'steal from the world' mean?",
    "options_en": ["Commit theft", "Live unnoticed", "Take wealth", "Escape secretly"],
    "answer_en": "Live unnoticed",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 73,
    "question_en": "What is the poet's 'world'?",
    "options_en": ["The entire earth", "His small farm", "Society", "The universe"],
    "answer_en": "His small farm",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 74,
    "question_en": "How does the poet view time?",
    "options_en": ["As enemy", "As friend", "As meaningless", "As money"],
    "answer_en": "As friend",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 75,
    "question_en": "What does 'paternal acres' symbolize?",
    "options_en": ["Tradition", "Wealth", "Freedom", "Roots and stability"],
    "answer_en": "Roots and stability",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 76,
    "question_en": "What is 'health' in the poem?",
    "options_en": ["Physical only", "Mental only", "Both physical and mental", "Spiritual only"],
    "answer_en": "Both physical and mental",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 77,
    "question_en": "How should the poet's life end?",
    "options_en": ["With a bang", "With a whimper", "Without drama", "Tragically"],
    "answer_en": "Without drama",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 78,
    "question_en": "What does the poet mean by 'my own'?",
    "options_en": ["Selfishness", "Self-sufficiency", "Loneliness", "Wealth"],
    "answer_en": "Self-sufficiency",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 79,
    "question_en": "What is the poet's religion?",
    "options_en": ["Christianity", "Nature worship", "Self-knowledge", "Not specified"],
    "answer_en": "Not specified",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 80,
    "question_en": "How does the poet view society?",
    "options_en": ["As necessary", "As optional", "As harmful", "As enjoyable"],
    "answer_en": "As optional",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 81,
    "question_en": "What does 'blest' contrast with?",
    "options_en": ["Cursed", "Wealthy", "Famous", "Powerful"],
    "answer_en": "Famous",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 82,
    "question_en": "What is 'solitude' not?",
    "options_en": ["Loneliness", "Peace", "Contentment", "Freedom"],
    "answer_en": "Loneliness",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 83,
    "question_en": "How many wishes does the poet have?",
    "options_en": ["One", "Three", "Many", "Few"],
    "answer_en": "Few",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 84,
    "question_en": "What does 'whistle' represent?",
    "options_en": ["Happiness", "Boredom", "Calling animals", "Music"],
    "answer_en": "Happiness",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 85,
    "question_en": "How should the poet's death be?",
    "options_en": ["Soon", "Late", "Timely", "Unexpected"],
    "answer_en": "Timely",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 86,
    "question_en": "What is the poet's 'book' made of?",
    "options_en": ["Paper", "Experiences", "Thoughts", "Memories"],
    "answer_en": "Thoughts",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 87,
    "question_en": "What does 'meditate' involve?",
    "options_en": ["Sitting still", "Thinking deeply", "Praying aloud", "Reading books"],
    "answer_en": "Thinking deeply",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 88,
    "question_en": "How does the poet view old age?",
    "options_en": ["With fear", "With acceptance", "With regret", "Not mentioned"],
    "answer_en": "With acceptance",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 89,
    "question_en": "What does the poet mean by 'steal away'?",
    "options_en": ["Commit theft", "Die quietly", "Leave secretly", "Live privately"],
    "answer_en": "Live privately",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 90,
    "question_en": "What is 'peace' in the poem?",
    "options_en": ["Absence of war", "Inner calm", "Silence", "Sleep"],
    "answer_en": "Inner calm",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 91,
    "question_en": "How should the poet's life be?",
    "options_en": ["Recorded", "Forgotten", "Lived fully", "Simple and quiet"],
    "answer_en": "Simple and quiet",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 92,
    "question_en": "What does 'unlamented' imply about relationships?",
    "options_en": ["No friends", "No mourning needed", "Unloved", "Isolated"],
    "answer_en": "No mourning needed",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 93,
    "question_en": "What is the poet's 'wealth'?",
    "options_en": ["Land", "Contentment", "Gold", "Herds"],
    "answer_en": "Contentment",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 94,
    "question_en": "How does the poet view nature?",
    "options_en": ["As resource", "As companion", "As enemy", "As decoration"],
    "answer_en": "As companion",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 95,
    "question_en": "What does 'sound' mean in 'sound sleep'?",
    "options_en": ["Noisy", "Healthy", "Deep", "Light"],
    "answer_en": "Deep",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 96,
    "question_en": "What is the poet's 'legacy'?",
    "options_en": ["His land", "His poem", "No legacy", "His philosophy"],
    "answer_en": "No legacy",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 97,
    "question_en": "How should time be spent?",
    "options_en": ["Productively", "In leisure", "In service", "In learning"],
    "answer_en": "In leisure",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 98,
    "question_en": "What does the poet reject about city life?",
    "options_en": ["Noise", "Crowds", "Fashion", "All of these"],
    "answer_en": "All of these",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 99,
    "question_en": "What is the ultimate goal?",
    "options_en": ["Heaven", "Contentment", "Fame", "Knowledge"],
    "answer_en": "Contentment",
    "attempted": false,
    "selected": ""
  },
  {
    "num": 100,
    "question_en": "What modern value does the poem challenge?",
    "options_en": ["Fame and recognition", "Hard work", "Education", "Technology"],
    "answer_en": "Fame and recognition",
    "attempted": false,
    "selected": ""
  }
];
// --------------------------- GLOBAL VARS -----------------------------
let currentQuestion = 0;
let language = "en";
let timeLeft = 60 * 60; 
let timerInterval;

// ----------------- Load Question -----------------
function loadQuestion(index) {
    const q = questions[index];
    if (!q) return; //  undefined error fix

    document.getElementById("question").textContent =
        `${q.num}. ${language === "en" ? q.question_en : q.question_hi}`;

    document.getElementById("questionCounter").textContent =
        `Question ${index + 1} of ${questions.length}`;

    const optionsElement = document.getElementById("options");
    optionsElement.innerHTML = "";

    const options = language === "en" ? q.options_en : q.options_hi;

    options.forEach(option => {
        const isSelected = q.selected === option;

        const div = document.createElement("div");
        div.className = "option-box";

        div.style = `
            border: 2px solid ${isSelected ? "#007bff" : "#ccc"};
            background-color: ${isSelected ? "#e7f1ff" : "white"};
            padding: 10px;
            border-radius: 8px;
            margin: 6px 0;
            cursor: pointer;
        `;

        div.innerHTML = `
            <input type="radio" name="option" value="${option}" 
            ${isSelected ? "checked" : ""} style="margin-right:8px;">
            ${option}
        `;

        div.addEventListener("click", () => {
            markAttempted(index, option);
            loadQuestion(index);
        });

        optionsElement.appendChild(div);
    });

    updateNavigation();
}

// ----------------- Attempt Mark -----------------
function markAttempted(index, selectedAnswer) {
    questions[index].attempted = true;
    questions[index].selected = selectedAnswer;
    updateNavigation();
}

// ----------------- Next / Previous -----------------
function nextQuestion() {
    if (currentQuestion < questions.length - 1) {
        currentQuestion++;
        loadQuestion(currentQuestion);
    }
}

function prevQuestion() {
    if (currentQuestion > 0) {
        currentQuestion--;
        loadQuestion(currentQuestion);
    }
}

function changeLanguage() {
    language = document.getElementById("languageSelect").value;
    loadQuestion(currentQuestion);
}

// ----------------- Final Submit -----------------
function submitQuiz() {
    let confirmation = confirm("Are you sure you want to submit the test?");
    if (!confirmation) return;

    let attempted = 0;
    let notAttempted = 0;
    let score = 0;
    const results = [];

    questions.forEach(q => {
        if (q.attempted) {
            attempted++;

            if (q.selected === q.answer_en || q.selected === q.answer_hi) {
                score++;
            }
        } else {
            notAttempted++;
        }

        results.push({
            question: language === "en" ? q.question_en : q.question_hi,
            selected: q.selected || "Not Answered",
            correct: language === "en" ? q.answer_en : q.answer_hi
        });
    });

    localStorage.setItem("attempted", attempted);
    localStorage.setItem("notAttempted", notAttempted);
    localStorage.setItem("score", score);
    localStorage.setItem("results", JSON.stringify(results));

    let viewResult = confirm("Test submitted! Do you want to view result?");
    if (viewResult) {
        window.location.href = "/RTS/public/Deshbord/category/test/submit-test.html";
    }
}

// ----------------- Navigation Circles -----------------
function updateNavigation() {
    const nav = document.getElementById("circleContainer");
    nav.innerHTML = "";

    questions.forEach((q, i) => {
        let color = "gray";
        if (i === currentQuestion) color = "blue";
        else if (q.attempted) color = "green";

        nav.innerHTML += `
            <div class="circle" style="background:${color};"
            onclick="jumpToQuestion(${i})">${i + 1}</div>
        `;
    });
}

function jumpToQuestion(index) {
    currentQuestion = index;
    loadQuestion(index);
}

// ----------------- Timer -----------------
function startTimer() {
    const timerElement = document.getElementById("timer");

    timerInterval = setInterval(() => {
        if (timeLeft <= 0) {
            clearInterval(timerInterval);
            alert("Time's up!");
            submitQuiz();
        } else {
            const hours = String(Math.floor(timeLeft / 3600)).padStart(2, "0");
            const minutes = String(Math.floor((timeLeft % 3600) / 60)).padStart(2, "0");
            const seconds = String(timeLeft % 60).padStart(2, "0");

            timerElement.textContent = `Time Left: ${hours}:${minutes}:${seconds}`;
            timeLeft--;
        }
    }, 1000);
}

// ----------------- Camera & Movement Detection -----------------
let videoStream;
let movementCount = 0;

function startCamera() {
    const container = document.createElement("div");
    container.id = "camera-container";
    container.style = `
        position:fixed; top:10px; left:10px; width:130px; height:130px;
        border-radius:50%; overflow:hidden; border:3px solid red; z-index:9999;
    `;

    document.body.appendChild(container);

    const video = document.createElement("video");
    video.autoplay = true;
    video.playsinline = true;
    video.style = "width:100%; height:100%; object-fit:cover;";
    container.appendChild(video);

    navigator.mediaDevices.getUserMedia({ video: true })
        .then(stream => {
            video.srcObject = stream;
            videoStream = stream;
            detectMovement(video);
        })
        .catch(() => alert("Camera access denied!"));
}

function detectMovement(video) {
    const canvas = document.createElement("canvas");
    const ctx = canvas.getContext("2d");
    canvas.width = 160;
    canvas.height = 160;

    let lastData = null;

    setInterval(() => {
        ctx.drawImage(video, 0, 0, 160, 160);
        const data = ctx.getImageData(0, 0, 160, 160);

        if (lastData) {
            let diff = 0;
            for (let i = 0; i < data.data.length; i += 4) {
                diff += Math.abs(data.data[i] - lastData.data[i]);
            }

            if (diff > 1000000) {
                movementCount++;

                if (movementCount === 1) alert("⚠ Alert 1: No movement detected!");
                if (movementCount === 2) alert("⚠ Alert 2: Head not moving!");
                if (movementCount === 3) {
                    alert("⚠ Alert 3: Restarting test...");
                    restartTest();
                }
            }
        }
        lastData = data;

    }, 2000);
}

function restartTest() {
    if (videoStream) videoStream.getTracks().forEach(t => t.stop());

    const cam = document.getElementById("camera-container");
    if (cam) cam.remove();

    movementCount = 0;
    currentQuestion = 0;
    timeLeft = 60 * 60;

    questions.forEach(q => {
        q.attempted = false;
        q.selected = null;
    });

    loadQuestion(0);
    startTimer();
    startCamera();
}

// ----------------- Page Load -----------------
window.onload = function () {
    loadQuestion(currentQuestion);
    startTimer();
    startCamera();
};